function view_div(e){const t=["assign","remove","view","logs"];t.includes(e)&&t.forEach(t=>{t!=e&&"block"==$(`#${t}_iqa_div`)[0].style.display&&($(`#${t}_iqa_div`)[0].style.display="none")})}function select_form(e){if("assign"==e||"remove"==e){const t=$(`#${e}_iqa_div`)[0],n=$(`#${e}_error`)[0],s=$(`#${e}_success`)[0],i=$(`#${e}_au`)[0];$(`#${e}_iqa_btn`)[0].addEventListener("click",()=>{if(view_div(e),"block"==t.style.display)t.style.display="none";else if("none"==t.style.display){i.innerHTML="<option disabled value='' selected>Choose a User</option>",n.style.display="none",s.style.display="none";const r=new XMLHttpRequest;r.open("POST",`./classes/inc/admin_${e}_iqa_render.inc.php`,!1),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.onload=function(){if(200==this.status){const e=JSON.parse(this.responseText);e.error?(n.innerText=e.error,n.style.display="block"):e.return?i.innerHTML=e.return:(n.innerText="no users available",n.style.display="block")}else n.innerText="Loading error",n.style.display="block"},r.send(),t.style.display="block"}}),$(`#${e}_iqa_form`)[0].addEventListener("submit",t=>{if(t.preventDefault(),""==i.value)n.innerText="No input provided",n.style.display="block";else{n.style.display="none",s.style.display="none";const t=new XMLHttpRequest;t.open("POST",`./classes/inc/admin_${e}_iqa.inc.php`,!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.onload=function(){if(200==this.status){const t=JSON.parse(this.responseText);t.error?(n.innerText=t.error,n.style.display="block"):t.return?(s.innerText="Success",$(`#${e}_au option[value='${i.value}']`)[0].remove(),$(`#${e}_au option[value='']`).prop("selected",!0),s.style.display="block"):(n.innerText="Submit error",n.style.display="block")}else n.innerText="Connection error",n.style.display="block"},t.send(`id=${i.value}`)}})}}function view_data(e){if("view"==e||"logs"==e){const t=$(`#${e}_iqa_div`)[0],n=$(`#${e}_error`)[0],s=$(`#${e}_iqa_content`)[0];$(`#${e}_iqa_btn`)[0].addEventListener("click",()=>{if(view_div(e),"block"==t.style.display)t.style.display="none";else if("none"==t.style.display){n.style.display="none",s.style.display="none";const i=new XMLHttpRequest;switch(i.open("POST",`./classes/inc/admin_${e}_iqa_render.inc.php`,!1),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onload=function(){if(200==this.status){const e=JSON.parse(this.responseText);e.error?(n.innerText=e.error,n.style.display="block"):e.return?(s.innerHTML=e.return,s.style.display="block"):(n.innerText="No data available",n.style.display="block")}else n.innerText="Connection error",n.style.display="block"},e){case"logs":i.send(`sd=${$("#startdate")[0].value}&ed=${$("#enddate")[0].value}`);break;default:i.send()}t.style.display="block"}})}}function header_clicked(e,t){if("view"==e||"logs"==e){const n=$(`#${e}_thead`).find("tr:first th");let s="asc";for(let e=0;e<n.length;e++)if(e===t)switch(n[e].getAttribute("sort")){case"asc":n[e].setAttribute("sort","desc"),n[e].querySelector("span").innerHTML="&darr;",s="desc";break;case"desc":case"":n[e].setAttribute("sort","asc"),n[e].querySelector("span").innerHTML="&uarr;"}else n[e].setAttribute("sort",""),n[e].querySelector("span").innerHTML="";const i=$(`#${e}_tbody`).find("tr");if(i.length>1){let n=[];switch(i.each(function(e,s){const i=$(s).find("td");let r=[];i.each(function(e,t){!0===/[0-9]/.test(t.innerText)&&!0===t.innerText.includes("/")&&!1===/[a-zA-Z]/.test(t.innerText)?(tmpString=t.innerText.split("/"),r.push([t.getAttribute("dtval"),"date"])):t.querySelector("a")?r.push([t.innerText,t.querySelector("a").getAttribute("href")]):r.push([t.innerText,null])});const a=r[0];r[0]=r[t],r[t]=a,n.push(r)}),s){case"asc":!0===/[0-9]/.test(n[0][0])&&!1===/[a-zA-Z]/.test(n[0][0])?n.sort(function(e,t){return parseFloat(e[0])-parseFloat(t[0])}):n.sort(function(e,t){const n=e[0][0],s=t[0][0];return n<s?-1:s<n?1:0});break;case"desc":n.reverse()}let r=[];n.forEach(function(e){const n=e[t];e[t]=e[0],e[0]=n,r.push(e)});const a=$(`#${e}_tbody`)[0];a.innerHTML="",r.forEach(function(e){let t="<tr>";for(let n=0;n<e.length;n++)switch(e[n][1]){case"date":const s=e[n][0];e[n][0]=new Date(1e3*e[n][0]),t+=`<td dtval='${s}'>${String(e[n][0].getDate()).padStart(2,"0")}/${String(e[n][0].getMonth()+1).padStart(2,"0")}/${e[n][0].getFullYear()} ${String(e[n][0].getHours()).padStart(2,"0")}:${String(e[n][0].getMinutes()).padStart(2,"0")}:${String(e[n][0].getSeconds()).padStart(2,"0")}</td>`;break;case null:t+=`<td>${e[n][0]}</td>`;break;default:t+=`<td><a href='window.location.href=${e[n][1]}'>${e[n][0]}</a></td>`}t+="</tr>",a.innerHTML+=t})}}}select_form("assign"),select_form("remove"),view_data("view"),view_data("logs"),$("#logs_iqa_filter_form")[0].addEventListener("submit",e=>{e.preventDefault();const t=$("#logs_error")[0],n=$("#logs_iqa_content")[0];n.style.display="none",t.style.display="none";const s=new XMLHttpRequest;s.open("POST","./classes/inc/admin_logs_iqa_render.inc.php",!1),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.onload=function(){if(200==this.status){const e=JSON.parse(this.responseText);e.error?(t.innerText=e.error,t.style.display="block"):e.return?(n.innerHTML=e.return,n.style.display="block"):(t.innerText="No data available",t.style.display="block")}else t.innerText="Connection error",t.style.display="block"},s.send(`sd=${$("#startdate")[0].value}&ed=${$("#enddate")[0].value}`)});