function view_div(e,t){const s=["assign","remove","view","logs"];!s.includes(e)||"iqa"!=t&&"course"!=t&&"learner"!=t||s.forEach(s=>{s!=e&&"block"==$(`#${s}_${t}_div`)[0].style.display&&($(`#${s}_${t}_div`)[0].style.display="none")})}function select_form(e,t){if(!("assign"!=e&&"remove"!=e||"iqa"!=t&&"course"!=t&&"learner"!=t)){const s=$(`#${e}_${t}_div`)[0],n=$(`#${e}_${t}_error`)[0],a=$(`#${e}_${t}_success`)[0],r=$(`#${e}_${t}_content`)[0];$(`#${e}_${t}_btn`)[0].addEventListener("click",()=>{const i=$(`#${e}_${t}_au`)[0];if(view_div(e,t),"block"==s.style.display)s.style.display="none";else if("none"==s.style.display){switch(t){case"iqa":i.innerHTML="<option disabled value='' selected>Choose a User</option>";break;case"course":i.innerHTML="<option disabled value='' selected>Choose a Course</option>";break;case"learner":switch(e){case"remove":i.innerHTML="<option disabled value='' selected>Choose a Assignment to remove</option>";break;case"assign":i.innerHTML="<option disabled value='' selected>Choose a Course</option>"}}n.style.display="none",a.style.display="none";const o=new XMLHttpRequest;o.open("POST",`./classes/inc/admin_${e}_render.inc.php`,!1),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onload=function(){if(200==this.status){const e=JSON.parse(this.responseText);e.error?(n.innerText=e.error,n.style.display="block"):e.return?r.innerHTML=e.return:(n.innerText="no data available",n.style.display="block")}else n.innerText="Loading error",n.style.display="block"},o.send(`t=${t}`),s.style.display="block"}}),$(`#${e}_${t}_form`)[0].addEventListener("submit",s=>{s.preventDefault();const r=$(`#${e}_${t}_au`)[0];if(""==r.value)n.innerText="No input provided",n.style.display="block";else{n.style.display="none",a.style.display="none";const s=new XMLHttpRequest;switch(s.open("POST",`./classes/inc/admin_${e}.inc.php`,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.onload=function(){if(200==this.status){const s=JSON.parse(this.responseText);if(s.error)n.innerText=s.error,n.style.display="block";else if(s.return){switch(a.innerText="Success",t){case"learner":switch(e){case"assign":$(`#${e}_${t}_au2 option[value='${$(`#${e}_${t}_au2`)[0].value}']`)[0].remove(),$(`#${e}_${t}_au2 option[value='']`).prop("selected",!0);break;case"remove":$(`#${e}_${t}_au option[value='${r.value}']`)[0].remove(),$(`#${e}_${t}_au option[value='']`).prop("selected",!0)}break;default:$(`#${e}_${t}_au option[value='${r.value}']`)[0].remove(),$(`#${e}_${t}_au option[value='']`).prop("selected",!0)}a.style.display="block"}else n.innerText="Submit error",n.style.display="block"}else n.innerText="Connection error",n.style.display="block"},t){case"learner":switch(e){case"assign":s.send(`id=${r.value}&t=${t}&l=${$(`#${e}_${t}_au2`)[0].value}&i=${$(`#${e}_${t}_au3`)[0].value}`);break;case"remove":s.send(`id=${r.value}&t=${t}`)}break;default:s.send(`id=${r.value}&t=${t}`)}}})}}function view_data(e,t){if(!("view"!=e&&"logs"!=e||"iqa"!=t&&"course"!=t&&"learner"!=t)){const s=$(`#${e}_${t}_div`)[0],n=$(`#${e}_${t}_error`)[0],a=$(`#${e}_${t}_content`)[0];$(`#${e}_${t}_btn`)[0].addEventListener("click",()=>{if(view_div(e,t),"block"==s.style.display)s.style.display="none";else if("none"==s.style.display){n.style.display="none",a.style.display="none";const r=new XMLHttpRequest;switch(r.open("POST",`./classes/inc/admin_${e}_render.inc.php`,!1),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.onload=function(){if(200==this.status){const e=JSON.parse(this.responseText);e.error?(n.innerText=e.error,n.style.display="block"):e.return?(a.innerHTML=e.return,a.style.display="block"):(n.innerText="No data available",n.style.display="block")}else n.innerText="Connection error",n.style.display="block"},e){case"logs":r.send(`sd=${$(`#${t}_startdate`)[0].value}&ed=${$(`#${t}_enddate`)[0].value}&t=${t}`);break;default:r.send(`t=${t}`)}s.style.display="block"}})}}function header_clicked(e,t,s){if(!("view"!=e&&"logs"!=e||"iqa"!=s&&"course"!=s&&"learner"!=s)){const n=$(`#${e}_${s}_thead`).find("tr:first th");let a="asc";for(let e=0;e<n.length;e++)if(e===t)switch(n[e].getAttribute("sort")){case"asc":n[e].setAttribute("sort","desc"),n[e].querySelector("span").innerHTML="&darr;",a="desc";break;case"desc":case"":n[e].setAttribute("sort","asc"),n[e].querySelector("span").innerHTML="&uarr;"}else n[e].setAttribute("sort",""),n[e].querySelector("span").innerHTML="";const r=$(`#${e}_${s}_tbody`).find("tr");if(r.length>1){let n=[];switch(r.each(function(e,s){const a=$(s).find("td");let r=[];a.each(function(e,t){!0===/[0-9]/.test(t.innerText)&&!0===t.innerText.includes("/")&&!1===/[a-zA-Z]/.test(t.innerText)?(tmpString=t.innerText.split("/"),r.push([t.getAttribute("dtval"),"date"])):t.querySelector("a")?r.push([t.innerText,t.querySelector("a").getAttribute("href")]):r.push([t.innerText,null])});const i=r[0];r[0]=r[t],r[t]=i,n.push(r)}),a){case"asc":!0===/[0-9]/.test(n[0][0])&&!1===/[a-zA-Z]/.test(n[0][0])?n.sort(function(e,t){return parseFloat(e[0])-parseFloat(t[0])}):n.sort(function(e,t){const s=e[0][0],n=t[0][0];return s<n?-1:n<s?1:0});break;case"desc":n.reverse()}let i=[];n.forEach(function(e){const s=e[t];e[t]=e[0],e[0]=s,i.push(e)});const o=$(`#${e}_${s}_tbody`)[0];o.innerHTML="",i.forEach(function(e){let t="<tr>";for(let s=0;s<e.length;s++)switch(e[s][1]){case"date":const n=e[s][0];e[s][0]=new Date(1e3*e[s][0]),t+=`<td dtval='${n}'>${String(e[s][0].getDate()).padStart(2,"0")}/${String(e[s][0].getMonth()+1).padStart(2,"0")}/${e[s][0].getFullYear()} ${String(e[s][0].getHours()).padStart(2,"0")}:${String(e[s][0].getMinutes()).padStart(2,"0")}:${String(e[s][0].getSeconds()).padStart(2,"0")}</td>`;break;case null:t+=`<td>${e[s][0]}</td>`;break;default:t+=`<td><a href='window.location.href=${e[s][1]}'>${e[s][0]}</a></td>`}t+="</tr>",o.innerHTML+=t})}}}function select_changed(e){"assign"!=e&&"remove"!=e||($(`.${e}au2`).each(function(e,t){$(this)[0].hidden=!0,$(this)[0].hidden=!0}),$(`.${e}au2_${$(`#${e}_learner_au`)[0].value}`).each(function(e,t){$(this)[0].hidden=!1,$(this)[0].disabled=!1}),$(`#${e}_learner_au2`)[0].style.display="block",$(`#${e}_learner_au3`)[0].style.display="block")}select_form("assign","iqa"),select_form("remove","iqa"),select_form("assign","course"),select_form("remove","course"),select_form("assign","learner"),select_form("remove","learner"),view_data("view","iqa"),view_data("logs","iqa"),view_data("view","course"),view_data("logs","course"),view_data("view","learner"),view_data("logs","learner"),["iqa","course","learner"].forEach(function(e){$(`#logs_${e}_filter_form`)[0].addEventListener("submit",t=>{t.preventDefault();const s=$(`#logs_${e}_error`)[0],n=$(`#logs_${e}_content`)[0];n.style.display="none",s.style.display="none";const a=new XMLHttpRequest;a.open("POST","./classes/inc/admin_logs_render.inc.php",!1),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.onload=function(){if(200==this.status){const e=JSON.parse(this.responseText);e.error?(s.innerText=e.error,s.style.display="block"):e.return?(n.innerHTML=e.return,n.style.display="block"):(s.innerText="No data available",s.style.display="block")}else s.innerText="Connection error",s.style.display="block"},a.send(`sd=${$(`#${e}_startdate`)[0].value}&ed=${$(`#${e}_enddate`)[0].value}&t=${e}`)})});